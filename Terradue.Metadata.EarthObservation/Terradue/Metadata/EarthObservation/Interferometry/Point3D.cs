using System;
using ProjNet.CoordinateSystems;
using ProjNet.CoordinateSystems.Transformations;
using GeoAPI.CoordinateSystems.Transformations;

namespace Terradue.Metadata.EarthObservation {

    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------

    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------

    public struct Point3D {

        public static Point3D FromGeographicCoordinates(double lon, double lat, double alt, DateTime time){
            var ggwgs84 = GeographicCoordinateSystem.WGS84;
            var gcwgs84 = ProjNet.CoordinateSystems.GeocentricCoordinateSystem.WGS84;
            var ctfac = new CoordinateTransformationFactory();
            ICoordinateTransformation trans = ctfac.CreateFromCoordinateSystems(ggwgs84, gcwgs84);

            var gccoords = trans.MathTransform.Transform(new double[]{ lon, lat, alt });

            return new Point3D(gccoords[0], gccoords[1], gccoords[2], time);
        }

        private double x, y, z;

        private DateTime time;

        public DateTime Time {
            get {
                return time;
            }
            set {
                time = value;
            }
        }

        //---------------------------------------------------------------------------------------------------------------------

        public double X { 
            get { return x; }
        }

        //---------------------------------------------------------------------------------------------------------------------

        public double Y { 
            get { return y; }
        }

        //---------------------------------------------------------------------------------------------------------------------

        public double Z { 
            get { return z; }
        }

        //---------------------------------------------------------------------------------------------------------------------

        public Point3D(double x, double y, double z, DateTime time) {
            this.x = x;
            this.y = y;
            this.z = z;
            this.time = time;
        }

    }

    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------

    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------

    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------

}
